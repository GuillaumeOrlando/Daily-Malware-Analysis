# Netwalker Ransomware DLL Hashing algorithm
# Guillaume Orlando
# 11/01/2021

dll_array = ["ntdll.dll", "kernel32.dll", "advapi32.dll", "shell32.dll", "mpr.dll"]

def is_printable(char):
    if (ord(char) >= 0x41 and ord(char) <= 0x5A):
        return chr(ord(char) + 32)
    else:
        return char

def resolve_dll(name):
    hash = 0xFFFFFFFF
    for char in name:
        a = is_printable(char)
        hash ^= ord(a)
        for x in range(8):
            hash = - (hash & 1) & 0xEDB88320 ^ (hash >> 1)
    return(hex(~hash & 0xFFFFFFFF))

for dll in dll_array:
    hash = resolve_dll(dll)
    print(dll, hash)


