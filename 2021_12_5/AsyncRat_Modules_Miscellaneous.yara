import "pe"

rule ASyncRat_Runtime_Module_Misc {
	meta:
		description = "AsyncRat v0.5.7B - Runtime Module Miscellaneous.DLL"
		author = "HomardBoy"
		date = "2021-12-5"

	strings:
		$str0 = "MsgPack" ascii
		$str1 = "System.Net.Sockets" ascii
		$str2 = "get_TcpClient" ascii
		$str3 = "get_IsConnected" ascii
		$str4 = "get_Hwid" ascii
		$str5 = "AsyncCallback" ascii
		$str6 = "Decompress" ascii
		$str7 = "GZipStream" ascii

		$mod = "Plugin" ascii
	
		$misc0 = "HandleDos" ascii
		$misc1 = "HandleLimeUSB" ascii
		$misc2 = "HandleShell" ascii
		$misc3 = "HandleTorrent" ascii
		$misc4 = "DosPost" ascii
		$misc5 = "userAgents" ascii
		$misc6 = "usbDirectory" ascii
		$misc = "StartShell" ascii

	condition:
		pe.characteristics and pe.DLL and 6 of ( $str* ) and all of ( $misc* ) and $mod
}
